<!DOCTYPE html>
<html lang="ko">
<head>
	<title>{SERVER_NAME}</title>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="robots" content="noindex, nofollow" />

	<!-- Mobile -->
	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="user-scalable=no, maximum-scale=1.0, minimum-scale=1.0, width=device-width, initial-scale=1.0" />

	<!-- shortcut -->
	<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/img/lineage.ico?{CACHE_VERSION}" type="image/x-icon">
	<link rel="icon" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/img/lineage.ico?{CACHE_VERSION}" type="image/x-icon">
	<link rel="apple-touch-icon" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/img/lineage_home.png?{CACHE_VERSION}" type="image/png">

	<!-- css -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xpressengine/xeicon@2.3.3/xeicon.min.css?{CACHE_VERSION}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/fonts.css?{CACHE_VERSION}" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/nc-cnb.css?{CACHE_VERSION}" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/l1.main.css?{CACHE_VERSION}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/my_style.css?{CACHE_VERSION}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/jquery.scrollbar.css?{CACHE_VERSION}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/community.css?{CACHE_VERSION}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/nccommunity-theme.css?{CACHE_VERSION}">
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/css/l1.board.css?{CACHE_VERSION}">
    
	<!-- js -->
 	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/jquery-3.3.1.min.js?{CACHE_VERSION}"></script>
 	
 	<!-- 스크립트 비활성화 유저 리다이렉트 -->
 	<noscript><meta http-equiv="Refresh" content="0; URL=/noscript" /></noscript>

	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/jquery.scrollbar.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/jquery.number.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/util.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/popup.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/message.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/storage.min.js?{CACHE_VERSION}"></script>
</head>
<style>
.fe-svg-arrow_down_s, .fe-svg-arrow_left_s, .fe-svg-arrow_right_s, .fe-svg-arrow_up_s, .fe-svg-close_circle, .fe-svg-comment, .fe-svg-comment_reply, .fe-svg-comments, .fe-svg-like_s, .fe-svg-picture, .fe-svg-reload, .fe-svg-top, .fe-svg-vote {fill: rgba(0,0,0,.45)!important; color: rgba(0,0,0,.45)!important;}
[class*=" board-list-"] .title .count, [class^=board-list-] .title .count {font-size: 13px; line-height: 1; color: rgba(0,0,0,.68);}
.board-list-card .comment {display:none;}
.board-write-btn {float: left; margin-top: 12px;}
@media (max-width: 960px){
	.board-write-btn {margin-left:12px;}
}
</style>
<script type="text/javascript">
function noBack(){	window.history.forward();	}

//전역 스크립트 변수 선언
const serverName		= '{SERVER_NAME}';
const suggestEnable	= '{SUGGEST_ENABLE}';
const getTime		= '{NOW}';
const cacheVersion		= '{CACHE_VERSION}';
const cnb		= {CNB};
const pageCnbType	= {PAGE_CNB_TYPE};
const pageCnbSubType	= {PAGE_CNB_SUB_TYPE};
const account		= {USER_DATA};
const boardType		= 'FREE';
const total_size		= {TOTAL_SIZE};
</script>
<body class="page-board">
	<!-- navi -->
	<div id="nc-cnb" class="nc-cnb nc-cnb--lineage custom-theme is-top" data-device=""></div>
	
	<div id="svg-container" style="display: none;"></div>
	
	<div id="container" class="container">
		<!-- page container -->
		<div class="wrap-header"><header class="header"><h1 class="header-title">커뮤니티</h1></header></div>
		<div class="section-contents">
			<div class="wrap-contents">
				<div id="ncCommunityList" class="nc-community-list l1-community-free uikit-nccommunity-node">
					<div class="board-top-utils">
						<div id="wrapSearch" class="wrap-search">
							<div id="ncCommunitySearchType" class="ui-dropdown-wrap board-search">
								<!-- mobile -->
								<div class="ui-dropdown ui-dropdown-elements">
									<div class="select">
										<select name="board-search">
											<option value="title,contents">제목+내용</option>
											<option value="title">제목</option>
											<option value="writer">작성자</option>
										</select>
										<i class="fe-icon-arrow_down"></i>
									</div>
								</div>
								<!-- pc -->
								<div class="ui-dropdown ui-dropdown-community">
									<div class="select">
										<span id="search_type">제목+내용</span>
										<input type="hidden" name="data_val" id="data_val" value="title,contents"/>
										<i class="fe-icon-arrow_down"></i>
									</div>
									<ul class="option">
										<li class="ui-dropdown-custom_items" data-textvalue="제목+내용" data-value="title,contents">제목+내용</li>
										<li class="ui-dropdown-custom_items" data-textvalue="제목" data-value="title">제목</li>
										<li class="ui-dropdown-custom_items" data-textvalue="작성자" data-value="writer">작성자</li>
									</ul>
								</div>
								<form name="search_board_form" class="ui-input-box ui-input-box-search" onsubmit="return search_check();">
									<input type="hidden" name="searchType" id="searchType"/>
					                			<input type="search" id="ncCommunitySearch" class="input-board-search" name="searchText" value="" placeholder="게시글 검색" required="" autocomplete="off" aria-label="게시글 검색">
									<button class="co-btn co-btn-reset" aria-label="취소" type="button"><i class="fe-icon-close_circle"></i></button>
									<button class="co-btn co-btn-clear" aria-label="검색어 초기화" type="button"></button>
								</form>
							</div>
						</div>
						<div class="board-btngroup">
							<div class="wrap-btn-type">
								<button class="btn-type-selected list" aria-label="타입선택"><svg class="fe-svg fe-svg-list"><use xlink:href="#fe-svg-list"></use></svg></button>
								<span class="btn-type-list">
									<button class="co-btn btn-list" aria-label="목록형"><svg class="fe-svg fe-svg-list"><use xlink:href="#fe-svg-list"></use></svg></button>
									<button class="co-btn btn-cards is-disabled" aria-label="카드형"><svg class="fe-svg fe-svg-card"><use xlink:href="#fe-svg-card"></use></svg></button>
								</span>
							</div>
							<span class="list-count-area">
								<div id="boardSize" class="ui-dropdown-wrap board-size">
									<!-- mobile -->
									<div class="ui-dropdown ui-dropdown-elements">
										<div class="select">
							          				<select name="board-size">
							          					<option data-textvalue="20개" value="20">20개</option>
							          					<option data-textvalue="30개" value="30">30개</option>
							          					<option data-textvalue="50개" value="50">50개</option>
							          				</select>
							          				<i class="fe-icon-arrow_down"></i>
							          			</div>
									</div>
									<!-- pc -->
									<div class="ui-dropdown ui-dropdown-community">
										<div class="select"><span id="search_count">20개</span><i class="fe-icon-arrow_down"></i></div>
										<ul class="option">
											<li class="ui-dropdown-custom_items" data-textvalue="20개" data-value="20">20개</li>
											<li class="ui-dropdown-custom_items" data-textvalue="30개" data-value="30">30개</li>
											<li class="ui-dropdown-custom_items" data-textvalue="50개" data-value="50">50개</li>
										</ul>
									</div>
								</div>
							</span>
							<button class="co-btn btn-reload" aria-label="새로고침" onClick="refreshform();"><svg class="fe-svg fe-svg-reload"><use xlink:href="#fe-svg-reload"></use></svg></button>
							<button class="co-btn co-btn-round btn-write" aria-label="글쓰기" onClick="javascript:location.href='/board/write';" style="z-index: 111111111111;"><svg class="fe-svg fe-svg-write"><use xlink:href="#fe-svg-write"></use></svg><span>글쓰기</span></button>
						</div>
					</div>

					<div class="ncCommunityNoticeList board-notice"></div>

					<ul class="ncCommunityBoardList board-list-default"></ul>
					<div class="wrap-community-more"></div>
					<div class="ncCommunityLoader nc-community-loader"><div class="loader-circle"></div></div>
					<a href="/board/write" class="co-btn co-btn-round btn-write board-write-btn">글쓰기</a>
					<div class="wrap-btn-top" style="float: right;">맨 위로<button class="co-btn-top_list" aria-label="맨 위로"></button></div>
				</div>
			</div>
		</div>
	
		<!-- wrap-footer -->
		<div class="wrap-footer"></div>
	</div>
	
	<!-- popup -->
	<div id="layer_alert" class="default" style="display:none;"></div>
	<div class="dimmed" style="display: none;">dimmed</div>

	<!-- script -->
 	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/init.min.js?{CACHE_VERSION}"></script>
	<script src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/js/board.min.js?{CACHE_VERSION}"></script>
<script type="text/javascript">
let board_list_count = 20;
let board_scrollY = 0;
let communityInfiniteList = JSON.parse(getSession('COMMUNITY_INFINITE_LIST'));
if (communityInfiniteList) {
	if (communityInfiniteList.board == boardType) {
		board_list_count = communityInfiniteList.list_count;
		board_scrollY = communityInfiniteList.scroll_Y;
		if (!board_list_count || board_list_count < 20) {
			board_list_count = 20;
			board_scrollY = 0;
		}
	}
	removeSession('COMMUNITY_INFINITE_LIST');
}

let parameter = {
	board_type:	boardType,	// 게시판 종류
	total_size:	total_size,	// 전체 길이
	current_num:	0,		// 현재 번호
	list_count:	board_list_count,	// 취득할 최대 수
	search_type:	'',		// 검색 타입
	search_text:	''		// 검색어
};

let boardRendar = function() {
	getDatasWithOption([{
		type: 'POST',
		url: '/define/board',
		dataType: 'json',
		contentType: 'application/json',
		Accept: 'application/json',
		data: parameter
	}], (data) => {
		$.each(data, function(key, element){
			if (element.key == 'TOP_' + boardType) {
				createTopBoard(element.value);
			} else {
				createBoard(element.value);
			}
		});
		$('.nc-community-loader').css('display', 'none');
		if (board_scrollY > 0) {
			window.scrollTo(0, board_scrollY);
		}
	}, (data) => {
		throw new Error("boardRendar from index.html Error");
	});
}

let createTopBoard = function(data){
	if (data.length > 0) {
		let tpl = '';
		$.each(data, function(key, element){
			tpl += `
	        		<div class="board-notice-item is-new" onClick="urlform('${element.rownum}', 'post', '/board/view');">
	        			<span class="category">공지</span>
	        			<a href="javascript:urlform('${element.rownum}', 'post', '/board/view');">${element.title}</a>
	        			<i class="fe-icon-new"></i>
				<div class="info"><span class="writer"><img src="https://cdn.jsdelivr.net/gh/bgserver002/bgsv@main/web/img/lineage_writer.png" alt=""></span></div>
			</div>
			`;
		});
		$('.ncCommunityNoticeList.board-notice').html(tpl);
	}
}

let createBoard = function(data){
	let tpl = '';
	if (data.length > 0) {
		$.each(data,function(key,element){//리스트수만큼 반복
			tpl += createBoardHtml(element);
		});

		let data_length = data.length;
		parameter.current_num += data_length;// 리스트수갱신
		parameter.total_size -= data_length;// 총길이 갱신
    		if (parameter.total_size <= 0 || (parameter.search_type != '' && parameter.search_text != '')) {
    			$('.wrap-community-more').html('');
    		} else {
    			$('.wrap-community-more').html('<button class="nc-comment-more"><span class="txt">더보기</span></button>');

			$('.wrap-community-more .nc-comment-more').on('click', function(e){
				boardMore();
			});
    		}
	} else {
		tpl = '<li class="no-data"><div class="no-data-desc"><em>등록된 글이 없습니다.</em></div></li>';
		$('.wrap-community-more').html('');
	}
	$('.ncCommunityBoardList').html(tpl);// html넣기
}

//새로고침 버튼
let refreshform = function(){
	parameter.total_size	= total_size;// 리스트수 초기화
	parameter.current_num	= 0;// 총길이 초기화
	parameter.list_count	= $('#search_count').text().substring(0, 2);
	parameter.search_type	= '';
	parameter.search_text	= '';
	board_list_count		= parameter.list_count;
	board_scrollY 		= 0;

	boardRendar();
}

//검색
let search_check = function(){
	const f = document.search_board_form;
	if (!f.searchText.value) {// 검색어 입력 체크
		return false;
	}
	parameter.total_size	= total_size;// 리스트수 초기화
	parameter.current_num	= 0;// 총길이 초기화
	parameter.list_count	= $('#search_count').text().substring(0, 2);
	parameter.search_type	= $('#data_val').val();// 검색타입
	parameter.search_text	= f.searchText.value;

	boardRendar();
	return false;
}

//최초 페이지 로드 후 렌더링
$(document).ready(function(){
	boardRendar();
});
</script>
</body>
</html>